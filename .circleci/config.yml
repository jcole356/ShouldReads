version: 2.1
orbs:
  ruby: circleci/ruby@0.1.2

jobs:
  build:
    docker:
      - image: circleci/ruby:2.5.7-node
      - image: circleci/postgres:9.4
    environment:
        POSTGRES_PASSWORD: circleci
    steps:
      - checkout
      - run:
          name: Which bundler?
          command: bundle -v
      - ruby/bundle-install
      - run:
          name: setup db
          command: bundle exec rake db:setup
      - run:
          name: rspec
          command: bundle exec rspec
  # test:
  #   docker:
  #     - image: circleci/ruby:2.5.7
  #   working_directory: ~/project
  #   steps:
  #     - run:
  #         name: PWD and ls
  #         command: pwd && ls
  #     - ruby/test

# workflows:
#   version: 2.1
#   build_and_test:
#     jobs:
#       - build
#       - test:
#           requires:
#            - build
